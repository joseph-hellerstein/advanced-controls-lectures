{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"id":"CispnEmU6rn-"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"BOor_aq27yd6"},"source":["# Preliminaries"]},{"cell_type":"code","execution_count":371,"metadata":{"executionInfo":{"elapsed":12858,"status":"ok","timestamp":1651377467770,"user":{"displayName":"Amelia Reesman","userId":"09108454811591261519"},"user_tz":420},"id":"mTHF_gtg7Mw9"},"outputs":[],"source":["!pip install -q control\n","!pip install -q tellurium\n","\n","import control\n","import numpy as np\n","import pandas as pd\n","import matplotlib.pyplot as plt\n","import tellurium as te"]},{"cell_type":"markdown","metadata":{"id":"SuALaEKS6sL_"},"source":["You will compare the linearized version of NONLINEAR_MDL with a Tellurium simulation of the model.\n","\n","1) (5 pts) Construct a function that takes as input a time and a species name, and outputs a plot that compares a tellurium simulation of the species with a linearized model for the species (with S1 as input, as we did in lecture 9). Remember to document your function and include tests (as described in the rules for writing reproducible software).\n","\n","2) (3 pts) Use this function to analyze S2 and S3 for the operating points  0, 0.3, and 2.\n","\n","3) (2 pts) Where are the largest discrepancies between the original simulation and the linearized models? Why?"]},{"cell_type":"markdown","metadata":{"id":"KQ1TyHnJP-HG"},"source":["# NONLINEAR_MDL"]},{"cell_type":"code","execution_count":2,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":235},"executionInfo":{"elapsed":172,"status":"error","timestamp":1651385948816,"user":{"displayName":"Amelia Reesman","userId":"09108454811591261519"},"user_tz":420},"id":"2NMt-dFmDvT3","outputId":"f5e5b5ba-5b54-4df6-a080-11b1117b0eaa"},"outputs":[{"output_type":"error","ename":"NameError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)","\u001b[0;32m<ipython-input-2-94e2bcddd3f5>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m     13\u001b[0m \u001b[0mS3\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;36m0\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     14\u001b[0m \"\"\"\n\u001b[0;32m---> 15\u001b[0;31m \u001b[0mNONLINEAR_RR\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mte\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mloada\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mNONLINEAR_MDL\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     16\u001b[0m \u001b[0mNONLINEAR_DATA\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mNONLINEAR_RR\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msimulate\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     17\u001b[0m \u001b[0;31m#NONLINEAR_RR.getFloatingSpeciesIds()\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mNameError\u001b[0m: name 'te' is not defined"]}],"source":["NONLINEAR_MDL = \"\"\"\n","JN1: S1 -> S2; k1*S1\n","JN2: S1 +  S2 -> 3 S3; k2*S1*S2\n","JN3: S3 -> ; k3*S3\n","JN4: 2 S1 + S3 -> S2; k4*S1*S3\n","\n","k1 = 2\n","k2 = 1.5\n","k3 = 1\n","k4 = 0.5\n","S1 = 10\n","S2 = 0\n","S3 = 0\n","\"\"\"\n","NONLINEAR_RR = te.loada(NONLINEAR_MDL)\n","NONLINEAR_DATA = NONLINEAR_RR.simulate()\n","#NONLINEAR_RR.getFloatingSpeciesIds()\n","#NONLINEAR_DATA[0:,0:1]\n","#NONLINEAR_DATA=NONLINEAR_RR.simulate()\n","#NONLINEAR_DATA[:1,1:]\n","NONLINEAR_RR.keys()\n","for key in keys:\n","  NONLINEAR_RR[key] = kwargs[key]\n"]},{"cell_type":"code","execution_count":377,"metadata":{"executionInfo":{"elapsed":147,"status":"ok","timestamp":1651377568365,"user":{"displayName":"Amelia Reesman","userId":"09108454811591261519"},"user_tz":420},"id":"dLeDirIifVwO"},"outputs":[],"source":["def NoName(MODEL_STR,time):\n","    '''\n","    Retrieves the value of state at the specified time.\n","    Changes the time of the roadrunner.\n","    \n","    Parameters\n","    ----------\n","    time: float\n","    roadrunner: ExtendedRoadrunner\n","    \n","    Returns\n","    -------\n","    list \n","    '''\n","    roadrunner = te.loada(MODEL_STR)\n","    MODEL_STR_DATA = roadrunner.simulate()\n","    roadrunner.reset()\n","    OP_Time = time \n","    if time > 0:\n","      roadrunner.simulate(0, OP_Time)  \n","    species_lst = roadrunner.getFloatingSpeciesIds()\n","    dct = {s: roadrunner[s] for s in species_lst}\n","    #v = list(dct.values())\n","    #OP_time = time\n","    #OP_vec = np.array(list(v(OP_time).values()))\n","    #NUM_STATE = len(vec)\n","    #X0 = np.array(list(dct(0).values()))#OP_MODLE_STR_DATA[:1,1:]\n","    #extract Jacobian  \n","    A = roadrunner.getFullJacobian()\n","\n","    B = [[1],\n","        [0],\n","        [0]] \n","    B= np.reshape(B, (NUM_STATE, 1))\n","    C = [0,0,1]  \n","    C = np.reshape(C, (1, NUM_STATE))\n","    D = 0 \n","\n","    #control.forced_response(control.StateSpace(A, B, C, D), TIMES , X0)\n","    #roadrunner.reset()\n","\n","    return (dct, "]},{"cell_type":"code","execution_count":378,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":150,"status":"ok","timestamp":1651377570318,"user":{"displayName":"Amelia Reesman","userId":"09108454811591261519"},"user_tz":420},"id":"FUHvFz4A8SuN","outputId":"070f8d78-cba4-49d7-be41-e37c6f73472d"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'S1': -4.963049894170401e-19,\n"," 'S2': 2.2697040671832824,\n"," 'S3': 0.0003738363986602917}"]},"metadata":{},"execution_count":378}],"source":["NoName(NONLINEAR_MDL,10)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"MthVsoB-8OYI"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"_cVOz4AaA99y"},"source":["# Clean Slate "]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ebf_kRY3X100"},"outputs":[],"source":["def getStateValues(time, roadrunner=NONLINEAR_RR):\n","    \"\"\"\n","    Retrieves the value of state at the specified time.\n","    Changes the time of the roadrunner.\n","    \n","    Parameters\n","    ----------\n","    time: float\n","    roadrunner: ExtendedRoadrunner\n","    \n","    Returns\n","    -------\n","    list \n","    \"\"\"\n","    roadrunner.reset()\n","    #Set operating point \n","    OP_TIME = time\n","    OP_VEC = roadrunner.getStateValues(OP_TIME)\n","    NUM_STATE = len(OP_VEC)\n","    if time > 0:\n","        roadrunner.simulate(0, time)\n","    species_lst = roadrunner.getFloatingSpeciesIds()\n","    StateDct = {s: roadrunner[s] for s in species_lst}\n","     list(dct.values())\n","        \n","# Tests\n","lst = getStateValues(0.5)\n","assert(len(lst) == 3)\n","lst1 = getStateValues(1)  # Get different values at a different time\n","#assert(all([lst[s] != lst1[s] for s in dct.keys()]))"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":218},"executionInfo":{"elapsed":171,"status":"error","timestamp":1651179441664,"user":{"displayName":"Amelia Reesman","userId":"09108454811591261519"},"user_tz":420},"id":"x6ozckxZBOof","outputId":"c01b85bf-c075-41ed-a2e1-93a8bdb860e3"},"outputs":[{"ename":"NameError","evalue":"ignored","output_type":"error","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)","\u001b[0;32m<ipython-input-22-3bc581cb23b2>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mNONLINEAR_RR\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mte\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mloada\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mNONLINEAR_MDL\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      2\u001b[0m \u001b[0mNONLINEAR_DATA\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mNONLINEAR_RR\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msimulate\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      3\u001b[0m \u001b[0mNONLINEAR_DATA\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;36m3\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      4\u001b[0m \u001b[0;31m#control.TransferFunction(NONLINEAR_DATA[1:], NONLINEAR_DATA[4:])\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mNameError\u001b[0m: name 'NONLINEAR_MDL' is not defined"]}],"source":["NONLINEAR_RR = te.loada(NONLINEAR_MDL)\n","NONLINEAR_DATA=NONLINEAR_RR.simulate()\n","NONLINEAR_DATA[:,3:]\n","#control.TransferFunction(NONLINEAR_DATA[1:], NONLINEAR_DATA[4:])\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":235},"executionInfo":{"elapsed":161,"status":"error","timestamp":1651359291971,"user":{"displayName":"Amelia Reesman","userId":"09108454811591261519"},"user_tz":420},"id":"ZjavVA1CCXzW","outputId":"253719e9-d84d-42f5-cee8-d13896bdfb36"},"outputs":[{"ename":"NameError","evalue":"ignored","output_type":"error","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)","\u001b[0;32m<ipython-input-33-22729af27c1a>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      2\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      3\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 4\u001b[0;31m \u001b[0mroadrunner\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mte\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mloada\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mMODEL_STR\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      5\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      6\u001b[0m \u001b[0;31m#Simulate nonlinear model\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mNameError\u001b[0m: name 'MODEL_STR' is not defined"]}],"source":["#def LINEARIZE(MODEL_SRT, OP_TIME, SPECIES):\n"," \n","  \n","roadrunner = te.loada(MODEL_STR)\n","\n","#Simulate nonlinear model\n","NONLINEAR_DATA = roadrunner.simulate()\n","\n","#Reset roadrunner simulation \n","#roadrunner.reset() #restets to time zero\n","#simulate at operating point\n","OP_TIME = 1\n","OP_VEC = roadrunnernp.array(list(getStateDct(time, **kwargs).values()))\n","#X0 = roadrunner.getStateValues(0)\n","#np.array(list(getStateDct(time, **kwargs).values()))\n","  \n","#extract Jacobian  \n","A = roadrunner.getFullJacobian()\n","\n","B = [[1],\n","      [0],\n","      [0]] #np.reshape(B, (NUM_STATE, 1))\n","C = [0,0,1]  #np.reshape(C, (1, NUM_STATE))\n","D = 0 \n","\n","ss = control.StateSpace(A, B, C, D)\n","\n","print(ss)"]},{"cell_type":"markdown","metadata":{"id":"5CKXXws9A16s"},"source":["# things I have tried and dont like "]},{"cell_type":"code","execution_count":null,"metadata":{"id":"OqjWYDofKIBR"},"outputs":[],"source":["NONLINEAR_RR = te.loada(NONLINEAR_MDL)\n","NONLINEAR_DATA=NONLINEAR_RR.simulate()\n","NONLINEAR_DF = arrtoDF(NONLINEAR_DATA)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"9ESKIFD3K-EQ"},"outputs":[],"source":["#def runSimulation(DataFrame, OP_TIME, species): #isPlot=true):\n","    '''\n","    Linearizes aroung operating point and produces plot of linear and nonlinear species \n","    \n","    Parameters\n","    ----------\n","    MODEL_Name : str\n","    OP_TIME : float\n","    Species : str\n","      e.g. 'S1', 'S2'\n","    isplot : TYPE, optional\n","        DESCRIPTION. The default is true.\n","\n","    Returns\n","    -------\n","    dict: \n","        key: pct\n","        value: DataFrame\n","\n","    '''\n","    roadrunner = te.loada(MODEL_STR)\n","    NONLIN = roadrunner[species]\n","    #simulate to operating point\n","    roadrunner.simulate(OP_TIME)\n","    OP_VEC = roadrunner.getStateValues(OP_TIME)\n","    NUM_STATE = len(OP_VEC)\n","    X0 = roadrunner.getStateValues(0)  \n","    #extract Jacobian  \n","    A = roadrunner.getFullJacobian() \n","    if not species in roadrunner.keys():\n","        raise ValueError(\"Unknown species name: %s\" % species)\n","    resultDct = {}\n","    for v in time:\n","        roadrunner.reset()\n","        NONLINEAR_SS = control.StateSpace(A,B,C,D)\n","        df = arrtoDF(control.forced_response(NONLINEAR_SS,  [0.1*v for v in range(51)], X0))\n","        #title = \"%s: %f (%d%%)\" %(parameter, newValue, percent)\n","        resultDct[species] = df\n","        #if isPlot:\n","          #  timePlots(df=df, title = title)\n","    return resultDct "]},{"cell_type":"markdown","metadata":{"id":"-t29CVVqMPt9"},"source":[""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"3Iq2cYbcO89j"},"outputs":[],"source":["def LINEARIZE(OP_TIME,roadrunner):\n","  \"\"\"\n","  Sets the operating point for Jacobian matrix \n","\n","  Parameteres\n","  ------\n","  OP_TIME = float\n","  roadrunner: ExtendedRoadrunner\n","\n"," \n","  Returns\n","  ------\n","  \n","  \"\"\"\n","  roadrunner.reset()\n"," \n","  #simulate to operating point\n","  roadrunner.simulate(OP_TIME)\n","  OP_VEC = roadrunner.getStateValues(OP_TIME)\n","  NUM_STATE = len(OP_VEC)\n","  X0 = roadrunner.getStateValues(0)\n","  #extract Jacobian  \n","  A = roadrunner.getFullJacobian() \n","  B = np.array((NUM_STATE, 1))\n","  C = np.array((1, NUM_STATE))\n","\n","  NONLINEAR_SS = control.StateSpace(A,B,C,D)\n","  results = control.forced_response(NONLINEAR_SS,  [0.1*v for v in range(51)], X0)\n","  return results"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":131},"executionInfo":{"elapsed":171,"status":"error","timestamp":1650953574363,"user":{"displayName":"Amelia Reesman","userId":"09108454811591261519"},"user_tz":420},"id":"0uY01ZjmfTKH","outputId":"b997039c-b587-4dbd-b765-8e5852faae81"},"outputs":[{"ename":"SyntaxError","evalue":"ignored","output_type":"error","traceback":["\u001b[0;36m  File \u001b[0;32m\"<ipython-input-24-5088b0bfd89f>\"\u001b[0;36m, line \u001b[0;32m2\u001b[0m\n\u001b[0;31m    for S1\u001b[0m\n\u001b[0m          ^\u001b[0m\n\u001b[0;31mSyntaxError\u001b[0m\u001b[0;31m:\u001b[0m invalid syntax\n"]}],"source":["# Determin B and C for steady state\n","  B = INPUT\n","  C = OUTPUT\n","  # D for steady state \n","  D=[[0.]]\n","\n","  NONLINEAR_SS = control.StateSpace(A,B,C,D)\n","  control.forced_response(NONLINEAR_SS,  [0.1*v for v in range(51)], X0=getStateValues(0))\n","\n","  NONLINEAR_SS = control.StateSpace(A,B,C,D)\n","  control.forced_response(NONLINEAR_SS,  [0.1*v for v in range(51)], X0=getStateValues(0))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"a_2-KAFQC-Fu"},"outputs":[],"source":["def analyze(time, species):\n","    \"\"\"\n","    Plots comparisons of the Tellurium simulation of the original model with\n","    its linearization at a time point for a particular species.\n","    The analysis is for NONLINEAR_MDL.\n","\n","    Parameters\n","    ----------\n","    time: float\n","    species: str\n","        e.g. \"S2\", \"S3\"\n","    \"\"\""]},{"cell_type":"code","execution_count":null,"metadata":{"id":"0OWVXk0rDwa4"},"outputs":[],"source":["for time in [0, 0.3, 2.0]:\n","    for species in [\"S2\", \"S3\"]:\n","        analyze(time, species)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":298},"executionInfo":{"elapsed":14,"status":"ok","timestamp":1650944533912,"user":{"displayName":"Amelia Reesman","userId":"09108454811591261519"},"user_tz":420},"id":"r_OTmsWlDvT_","outputId":"04b97ab7-6948-430a-e19e-4bd6f98728bd"},"outputs":[{"data":{"text/plain":["Text(0.5, 1.0, 'S3 with initial conditions')"]},"execution_count":20,"metadata":{},"output_type":"execute_result"},{"data":{"image/png":"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\n","text/plain":["<Figure size 432x288 with 1 Axes>"]},"metadata":{},"output_type":"display_data"}],"source":["# result.t are the times of the simulation\n","# result.y are the output values\n","plt.plot(result.t.flatten(), result.y.flatten())\n","plt.ylim([0, 10])\n","plt.title(\"S3 with initial conditions\")"]}],"metadata":{"colab":{"collapsed_sections":[],"name":"Homework 1: Evaluating the Accuracy of Linearization","toc_visible":true,"provenance":[],"authorship_tag":"ABX9TyPRIW5KU2w0IsvOYcIbBQP/"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}